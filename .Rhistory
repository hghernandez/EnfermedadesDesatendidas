sexo = "1.Varones"
tasas_ntd_df[tasas_ntd_df$sexo== sexo,]
tasas_ntd_df[tasas_ntd_df$sexo== sexo]
cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
sexo = "1.Varones"
cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
sexo = "1.Varones"
tasas_ntd_df[tasas_ntd_df$sexo== sexo,1] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
sexo = "1.Varones"
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
View(tasas_ntd_df)
load(file="tasas/tasas_ntd_suav.RData")
tasas_ntd_df$
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
View(tasas_ntd_df)
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr")
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
tasas_ntd_df$
sexo = unique(tasas_ntd_df$sexo)
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr")
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
nb2listw(matriz,style = "B"))
nb2listw(matriz,style = "B")
cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
)
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr")
sexo[1]
tasas_ntd_df[is.na(tasas_ntd_df)] <- 0
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]
tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
)
mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]
mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
sexo
sexo = unique(tasas_ntd_df$sexo)
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)]
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
)
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
print(sexo)
}
library(tidyverse)
library(R.utils)
library(foreign)
library(sf)
library(epitools)
library(spdep)
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
tasas_ntd_df[is.na(tasas_ntd_df)] <- 0
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
print(sexo)
}
colnames(tasas_ntd_df)[16] <- "dif_suav"
colnames(tasas_ntd_df)[15] <- "dif_li"
View(tasas_ntd_df)
source("~/Mis Documentos/EnfermedadesDesatendidas/AnalisisEspacial/script.R", echo=TRUE)
View(tasas_ntd_df)
View(tasas_ntd_df %>%
mutate(cuadrante= case_when((dif_suav > 0 & dif_li > 0) & `Pr(z != E(Ii))` <= 0.05  ~ "Alto-Alto",
(dif_suav < 0 & dif_li < 0) & `Pr(z != E(Ii))` <= 0.05  ~ "Bajo-Bajo",
(dif_suav < 0 & dif_li > 0) & `Pr(z != E(Ii))` <= 0.05 ~ "Bajo-Alto",
(dif_suav > 0 & dif_li < 0) & `Pr(z != E(Ii))` <= 0.05  ~ "Alto-Bajo",
TRUE ~ "No significativo")))
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))
View(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")))
mp <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))
mp2 <- moran.plot(as.vector(scale(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]])),nb2listw(matriz,style = "B"))
tasas_ntd_df[tasas_ntd_df$sexo== sexo[1]]
tasas_ntd_df[tasas_ntd_df$sexo== sexo[1],]
data <- tasas_ntd_df[tasas_ntd_df$sexo== sexo[1],]
data$quadrant <- NA
View(data)
mp
mp[,5]
data$lmp <- mp[,5]
data$quadrant <- NA
# high-high
data[(mp2$x >= 0 & mp2$wx >= 0) & (data$lmp <= 0.05), "quadrant"]<- 1
# low-low
data[(mp2$x <= 0 & mp2$wx <= 0) & (data$lmp <= 0.05), "quadrant"]<- 2
# high-low
data[(mp2$x >= 0 & mp2$wx <= 0) & (data$lmp <= 0.05), "quadrant"]<- 3
# low-high
data[(mp2$x <= 0 & mp2$wx >= 0) & (data$lmp <= 0.05), "quadrant"]<- 4
# non-significant
data[(data$lmp > 0.05), "quadrant"] <- 5
View(data)
library(tidyverse)
library(R.utils)
library(foreign)
library(sf)
library(epitools)
library(spdep)
load(file="tasas/tasas_ntd_suav.RData")
##%######################################################%##
#                                                          #
####                Estimo la I de Moran                ####
#                                                          #
##%######################################################%##
#Cargo la matriz de vecindad
matriz <- read.gal("matriz de vecindad/matriz")
tasas_ntd_df[is.na(tasas_ntd_df)] <- 0
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
View(tasas_ntd_df)
View(tasas_ntd_df %>%
mutate(cluster= case_when(`Pr(z != E(Ii))` > 0.05 ~ 'no significativo',
TRUE ~ mean)))
tasas_ntd_df <- tasas_ntd_df %>%
mutate(cluster= case_when(`Pr(z != E(Ii))` > 0.05 ~ 'no significativo',
TRUE ~ mean))
library(tidyverse)
library(R.utils)
library(foreign)
library(sf)
library(epitools)
library(spdep)
#Cargo la cartografia de los departamentos
deptos <- st_read(dsn= "cartografia/deptos",
layer = "pxdptodatosok")
#Arreglo las geometrias
deptos <- st_make_valid(deptos)
#Cargo la cartografia de las provincias
pcias <- st_read(dsn= "cartografia/provincias",
layer = "pxpciadatosok")
#Arreglo las geometrias
pcias <- st_make_valid(pcias)
#Selecciono caba como provincia
caba <- pcias %>% filter(link == '02')
#Excluyo antartida y caba
deptos <- deptos %>% filter(!link %in% c(94028,94021) & codpcia != '02')
#Uno los departamentos y caba
deptos <- deptos %>%
bind_rows(caba)
#Arreglo los datos
deptos <- deptos %>%
mutate(link= case_when(link== '02' ~ '02000', TRUE ~ link),
codpcia= case_when(link== '02000' ~ '02',TRUE ~ codpcia),
departamen= case_when(link== '02000' ~ 'CABA',TRUE ~ departamen))
library(leaflet)
leaflet(deptos) %>%
addPolygons()
View(deptos)
View(tasas_ntd_df)
deptos %>%
left_join(tasas_ntd_df %>% filter(grepl("3.",sexo)) %>% select(link,RME,suavizadas,cluster))
deptos <- deptos %>%
left_join(tasas_ntd_df %>% filter(grepl("3.",sexo)) %>% select(link,RME,suavizadas,cluster))
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(label= deptos@data$departamen,color = "grey")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(label= deptos$departamen,color = "grey")
unique(deptos$cluster)
deptos$cluster <- factor(deptos$cluster,levels = c(c("High-High", "Low-Low", "High-Low",
"Low-High", "no significativo")))
pal <- c("red", "blue", "lightpink", "skyblue2", "white")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~cluster,
fillOpacity = 0.7,
color = "black",
stroke = TRUE,
weight = 1,
popup = deptos$departamen)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~cluster,
fillOpacity = 0.7,
stroke = TRUE,
weight = 1,
popup = deptos$departamen)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~pal(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen)
colores_personalizados <- colorFactor(
palette = c("red", "blue", "green", "orange", "gray"),
domain = c("High-High", "Low-Low", "High-Low", "Low-High", "no significativo")
)
colores_personalizados <- colorFactor(
palette = c("red", "blue", "lightpink", "skyblue2", "white"),
domain = c("High-High", "Low-Low", "High-Low", "Low-High", "no significativo")
)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(position = "bottomright", # Posición de la leyenda
colors = colores_personalizados,
labels = levels(colores_personalizados),
title = "Cluster")
colores_personalizados
levels(colores_personalizados)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = colores_personalizados,
values= colores_personalizados())
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = colores_personalizados,
values= ~colores_personalizados())
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = colores_personalizados,
values= ~colores_personalizados)
colores_personalizados
colores_personalizados(cluster)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = colores_personalizados(cluster),
values= colores_personalizados(cluster))
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = ~colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = ~colores_personalizados(cluster),
values= ~colores_personalizados(cluster))
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = pal,
fill = deptos$cluster,
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = pal,
fill = deptos$cluster,
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = pal,
values= unique(deptos$cluster))
pal
unique(deptos$cluster)
deptos$cluster <- factor(deptos$cluster,levels = c("High-High", "Low-Low", "High-Low",
"Low-High", "no significativo"))
pal <- c("red", "blue", "lightpink", "skyblue2", "white")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = pal,
fill = deptos$cluster,
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = deptos$departamen) %>%
addLegend(pal = pal,
values= c("High-High", "Low-Low", "High-Low",
"Low-High", "no significativo"))
pal
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = pal,
fill = deptos$cluster,
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = c(deptos$departamen,deptos$cluster))
deptos$cluster
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fillColor = pal,
fill = deptos$cluster,
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster))
pal
pal <- as.factor("red", "blue", "lightpink", "skyblue2", "white")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = deptos$cluster,
fillColor = c("red", "blue", "lightpink", "skyblue2", "white"),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster))
colores_personalizados <- colorFactor(
palette = c("red", "blue", "lightpink", "skyblue2", "white"),
domain = c("High-High", "Low-Low", "High-Low", "Low-High", "no significativo")
)
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(cluster),
fillColor = colores_personalizados(cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster))
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster))
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster)) %>%
addLegend(pal =  colores_personalizados(deptos$cluster),
values=  colores_personalizados(deptos$cluster))
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster)) %>%
addLegend(position = "bottomright", # Posición de la leyenda
colors = colores_personalizados,
labels = levels(colores_personalizados),
title = "Cluster")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster)) %>%
addLegend(position = "bottomright", # Posición de la leyenda
colors = colores_personalizados(deptos$cluster),
labels = colores_personalizados(deptos$cluster),
title = "Cluster")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster)) %>%
addLegend(position = "bottomright", # Posición de la leyenda
colors = colores_personalizados(deptos$cluster),
labels = levels(colores_personalizados(deptos$cluster)),
title = "Cluster")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster)) %>%
addLegend(position = "bottomright", # Posición de la leyenda
colors = colores_personalizados(deptos$cluster),
labels = levels(colores_personalizados),
title = "Cluster")
leaflet(deptos) %>%
addTiles(urlTemplate = "https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png",
tileOptions(tms = TRUE,maxZoom = 14),attribution = '<a target="_blank" href="https://www.ign.gob.ar/argenmap/argenmap.jquery/docs/#datosvectoriales" style="color: black; text-decoration: underline; font-weight: normal;">Datos IGN Argentina // OpenStreetMap</a>') %>%
addPolygons(fill = colores_personalizados(deptos$cluster),
fillColor = colores_personalizados(deptos$cluster),
fillOpacity = 0.7,
stroke = TRUE,
weight = 2,
popup = paste0(deptos$departamen,"\n",deptos$cluster)) %>%
addLegend(position = "bottomright", # Posición de la leyenda
colors = c("red", "blue", "lightpink", "skyblue2", "white"),
labels = c("High-High", "Low-Low", "High-Low", "Low-High", "no significativo"),
title = "Cluster")
