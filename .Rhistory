substring(codmuer,1,4)== 'B663' ~ '16.Fascioliasis',
substring(codmuer,1,4)== 'B664' ~ '17.Paragonimiasis',
substring(codmuer,1,3)== 'A30' ~ '18.Lepra',
substring(codmuer,1,3)== 'B92' ~ '18.Lepra',
substring(codmuer,1,3)== 'A71' ~ '19.Tracoma',
substring(codmuer,1,4)== 'A311' ~ '20.Infeccion cutanea por micobacterias (Ãšlcera de Buruli)',
substring(codmuer,1,3)== 'A66' ~ '21.Frambesia',
substring(codmuer,1,3)== 'A67' ~ '22.Pinta',
substring(codmuer,1,3)== 'A65' ~ '23.Sifilis no venerea',
substring(codmuer,1,3)== 'A82' ~ '24.Rabia',
substring(codmuer,1,3)== 'A90' ~ '25.Dengue',
substring(codmuer,1,3)== 'A91' ~ '26.Dengue hemoragico',
substring(codmuer,1,4)== 'A920' ~ '27.Enfermedad por virus Chikungunya',
substring(codmuer,1,4)== 'A923' ~ '28.Enfermedad viral del oeste del Nilo',
substring(codmuer,1,3)== 'A95' ~ '29.Fiebre Amarilla'))
##%######################################################%##
#                                                          #
####            Creo la variable enfdes tot             ####
#                                                          #
##%######################################################%##
dataset <- dataset %>%
mutate(enf_desa_tot= case_when(substring(codmuer,1,3)>= 'B55' & substring(codmuer,1,3) <= 'B57' ~ '01.Protozoarios',
substring(codmuer,1,3)>= 'B65' & substring(codmuer,1,3) <= 'B79' ~ '02.Helmintos',
substring(codmuer,1,3)>= 'A30' & substring(codmuer,1,3) <= 'A71' | substring(codmuer,1,3) == 'B92' ~ '03.Bacterias'))
##%######################################################%##
#                                                          #
####           Arreglo el formato de provres            ####
#                                                          #
##%######################################################%##
dataset <- dataset %>%
mutate(provres = ifelse(provres < 10,paste0("0",provres),provres))
View(dataset %>%
group_by(provres) %>%
summarise(n= n()))
##%######################################################%##
#                                                          #
####             Arreglo la variable sexo               ####
#                                                          #
##%######################################################%##
dataset <- dataset %>%
mutate(sexo= case_when(sexo== 1 ~ '1.Varones',
sexo== 2 ~ '2.Mujeres',
sexo== 3 ~ '9.Indeterminado',
sexo== 9 ~ '9.Mal definido'))
casos_sin_caba <- dataset %>%
filter(!is.na(enf_desa_sub) & provres != '02')%>%
group_by(ano,provres,depres,enf_desa_sub,enf_desa_tot,edadquinq,sexo) %>%
summarise(casos= n()) %>% #Agrego total edad
bind_rows(group_by(.,ano,provres,depres,enf_desa_sub,enf_desa_tot,sexo)%>%
summarise(casos=sum(casos))%>%
mutate(edadquinq= '18.Total')) %>% #Agrego Ambos Sexos
bind_rows(group_by(.,ano,provres,depres,enf_desa_sub,enf_desa_tot,edadquinq)%>%
summarise(casos=sum(casos))%>%
mutate(sexo= '3.Ambos sexos')) %>% #Genero un total NTD
bind_rows(group_by(.,ano,provres,depres,edadquinq,sexo)%>%
summarise(casos=sum(casos))%>%
mutate(enf_desa_sub= '30.Total NTD',
enf_desa_tot='04.Total NTD')) %>%
filter(substring(sexo,1,1) != '9' & edadquinq != "18.Sin especificar")
casos_caba <- dataset %>%
filter(!is.na(enf_desa_sub) & provres == '02')%>%
group_by(ano,provres,enf_desa_sub,enf_desa_tot,edadquinq,sexo) %>%
summarise(casos= n()) %>% #Agrego total edad
bind_rows(group_by(.,ano,provres,enf_desa_sub,enf_desa_tot,sexo)%>%
summarise(casos=sum(casos))%>%
mutate(edadquinq= '18.Total')) %>% #Agrego Ambos Sexos
bind_rows(group_by(.,ano,provres,enf_desa_sub,enf_desa_tot,edadquinq)%>%
summarise(casos=sum(casos))%>%
mutate(sexo= '3.Ambos sexos')) %>% #Genero un total NTD
bind_rows(group_by(.,ano,provres,edadquinq,sexo)%>%
summarise(casos=sum(casos))%>%
mutate(enf_desa_sub= '30.Total NTD',
enf_desa_tot='04.Total NTD')) %>%
filter(substring(sexo,1,1) != '9' & edadquinq != "18.Sin especificar") %>%
mutate(depres = '000')
View(casos_caba)
casos_caba %>%
bind_rows(casos_sin_caba)
casos_caba <- dataset %>%
filter(!is.na(enf_desa_sub) & provres == '02')%>%
group_by(ano,provres,enf_desa_sub,enf_desa_tot,edadquinq,sexo) %>%
summarise(casos= n()) %>% #Agrego total edad
bind_rows(group_by(.,ano,provres,enf_desa_sub,enf_desa_tot,sexo)%>%
summarise(casos=sum(casos))%>%
mutate(edadquinq= '18.Total')) %>% #Agrego Ambos Sexos
bind_rows(group_by(.,ano,provres,enf_desa_sub,enf_desa_tot,edadquinq)%>%
summarise(casos=sum(casos))%>%
mutate(sexo= '3.Ambos sexos')) %>% #Genero un total NTD
bind_rows(group_by(.,ano,provres,edadquinq,sexo)%>%
summarise(casos=sum(casos))%>%
mutate(enf_desa_sub= '30.Total NTD',
enf_desa_tot='04.Total NTD')) %>%
filter(substring(sexo,1,1) != '9' & edadquinq != "18.Sin especificar") %>%
mutate(depres = 000)
casos_caba %>%
bind_rows(casos_sin_caba)
casos <- casos_caba %>%
bind_rows(casos_sin_caba)
View(casos)
fix_cod <- function(x){
x <- ifelse(stringr::str_length(x)== 1,paste0('00',x),
ifelse(stringr::str_length(x)== 2,paste0('0',x),as.character(x)))
return(x)
}
casos <- casos %>%
mutate(depres= fix_cod(depres))
save(casos, file="datosMort/data.RData")
library(tidyverse)
library(R.utils)
library(foreign)
library(sf)
library(epitools)
library(spdep)
library(maptools)
load("datosMort/data.RData")
ntd <- casos %>%
filter(grepl("Total",enf_desa_sub))
pob_deptos <- loadObject("PoblacionesEstimadas/pobdeptos0125.Rbin")
View(pob_deptos)
View(pob_deptos)
pob_deptos %>%
filter(codprov== 2) %>%
group_by(ano,codprov,sexo,gredad) %>%
summarise(poblacion= sum(poblacion))%>%
mutate(coddep= 000,
nomdep= 'Total CABA')
pob_caba <- pob_deptos %>%
filter(codprov== 2) %>%
group_by(ano,codprov,sexo,gredad) %>%
summarise(poblacion= sum(poblacion))%>%
mutate(coddep= 000,
nomdep= 'Total CABA')
pob_sin_caba <- pob_deptos %>%
filter(codprov!= 2) %>%
group_by(ano,codprov,coddep,nomdep,sexo,gredad) %>%
summarise(poblacion= sum(poblacion))
pob_caba %>%
bind_rows(pob_sin_caba)
pob_deptos <- pob_caba %>%
bind_rows(pob_sin_caba)
pob_deptos <- pob_deptos %>%
mutate(coddep= fix_cod(coddep),
codprov= ifelse(codprov < 10,paste0('0',codprov),codprov))
fix_cod <- function(x){
x <- ifelse(stringr::str_length(x)== 1,paste0('00',x),
ifelse(stringr::str_length(x)== 2,paste0('0',x),as.character(x)))
return(x)
}
pob_deptos <- pob_deptos %>%
mutate(coddep= fix_cod(coddep),
codprov= ifelse(codprov < 10,paste0('0',codprov),codprov))
str(pob_deptos)
pob_deptos %>%
mutate(coddep= fix_cod(coddep),
codprov= ifelse(codprov < 10,paste0('0',codprov),codprov))
str(pob_caba)
str(pob_sin_caba)
pob_caba <- pob_deptos %>%
filter(codprov== 2) %>%
group_by(ano,codprov,sexo,gredad) %>%
summarise(poblacion= sum(poblacion))%>%
mutate(coddep= 000,
nomdep= 'Total CABA') %>%
as.data.frame()
pob_sin_caba <- pob_deptos %>%
filter(codprov!= 2) %>%
group_by(ano,codprov,coddep,nomdep,sexo,gredad) %>%
summarise(poblacion= sum(poblacion)) %>%
as.data.frame()
pob_deptos <- pob_caba %>%
bind_rows(pob_sin_caba)
fix_cod <- function(x){
x <- ifelse(stringr::str_length(x)== 1,paste0('00',x),
ifelse(stringr::str_length(x)== 2,paste0('0',x),as.character(x)))
return(x)
}
pob_deptos <- pob_deptos %>%
mutate(coddep= fix_cod(coddep),
codprov= ifelse(codprov < 10,paste0('0',codprov),codprov))
ntd <- pob_deptos %>%
filter(ano >= 2004 & ano <= 2018) %>%
left_join(ntd, by= c("ano","codprov"="provres","coddep"="depres","sexo","gredad"="edadquinq")) %>%
mutate(link= paste0(codprov,coddep)) %>%
fill(enf_desa_sub,.direction = "downup") %>%
fill(enf_desa_tot,.direction = "downup")
#Seteo los valroes NULL a 0
ntd[is.na(ntd)] <- 0
std = ntd %>%
filter(gredad != '18.Total')%>%
group_by(enf_desa_sub,sexo,gredad) %>%
summarise(casos=sum(casos),
poblacion=sum(poblacion)) %>%
mutate(order= as.numeric(substring(gredad,1,2))) %>%
arrange(sexo,order)
ntd_casos <- ntd %>%
filter(gredad != '18.Total')%>%
group_by(link,enf_desa_sub,sexo,gredad) %>%
summarise(casos=sum(casos),
poblacion=sum(poblacion)) %>%
mutate(order= as.numeric(substring(gredad,1,2))) %>%
arrange(link,sexo,order)
unique(ntd$coddep)
unique(ntd$link)
length(unique(ntd$link))
512*3
tasas_ntd <- list()
for(i in 1:1536){
for(j in 1:3){
tasas_ntd[[i]] <- ageadjust.indirect(count = ntd_casos[(1+17*(i-1)):(17+17*(i-1)),5],
pop= ntd_casos[(1+17*(i-1)):(17+17*(i-1)),6],
stdcount = std[(1+17*(j-1)):(17+17*(j-1)),4],
stdpop= std[(1+17*(j-1)):(17+17*(j-1)),5],
stdrate = std[(1+17*(j-1)):(17+17*(j-1)),4]/std[(1+17*(j-1)):(17+17*(j-1)),5])
}
print(i)
}
tasas_ntd_df <- as.data.frame(1:1536)
tasas_ntd_df$observados <- 0
tasas_ntd_df$esperados <- 0
tasas_ntd_df$RME <- 0
tasas_ntd_df$ic_inf <- 0
tasas_ntd_df$ic_sup <- 0
for(i in 1:1536){
tasas_ntd_df[i,]$observados <- tasas_ntd[[i]]$sir[1]
tasas_ntd_df[i,]$esperados <- tasas_ntd[[i]]$sir[2]
tasas_ntd_df[i,]$RME <- tasas_ntd[[i]]$sir[3]*100
tasas_ntd_df[i,]$ic_inf <- tasas_ntd[[i]]$sir[4]*100
tasas_ntd_df[i,]$ic_sup <- tasas_ntd[[i]]$sir[5]*100
print(i)
}
s <- unique(ntd_casos$sexo)
tasas_ntd_df$sexo <- rep(s,532)
tasas_ntd_df$sexo <- rep(s,512)
l <- unique(ntd_casos$link)
tasas_ntd_df$link <- rep(l,each= 3)
tasas_ntd_df[,1] <- "Total NTD"
colnames(tasas_ntd_df)[1] <- 'Evento'
View(tasas_ntd_df)
save(tasas_ntd_df,file="tasas/tasas_ntd.RData")
library(tidyverse)
library(R.utils)
library(foreign)
library(sf)
library(epitools)
library(spdep)
load("tasas/tasas_ntd.RData")
tasas_ntd_df %>%
filter(!link %in% c(94028,94021)) %>%
distinct(n = n_distinct(link))
matriz <- read.gal("matriz de vecindad/matriz")
matriz
tasas_ntd_df <- tasas_ntd_df %>%
filter(!link %in% c(94028,94021))
View(tasas_ntd_df)
View(tasas_ntd_df)
i <- 1
tasas_ntd_df[(1+3*(i-1)),9] <- EBlocal(tasas_ntd_df[(1+3*(i-1)),2],tasas_ntd_df[(1+3*(i-1)),3],matriz)
tasas_ntd_df[(1+3*(i-1)),2]
tasas_ntd_df[(1+3*(i-1)),3]
matriz
EBlocal(tasas_ntd_df[(1+3*(i-1)),2],tasas_ntd_df[(1+3*(i-1)),3],matriz)
EBlocal(tasas_ntd_df %>% filter(sexo== '3.Ambos sexos')
%>% select(observados),tasas_ntd_df %>% filter(sexo== '3.Ambos sexos')
%>% select(esperados),matriz)
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos')
%>% select(observados)
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos')
%>% select(observados)
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(observados)
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(esperados)
EBlocal(tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(observados),
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(esperados),matriz)
nrow(tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(observados))
matriz
nrow(tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(esperados))
EBlocal(tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(observados),
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(esperados),
matriz)
auckland <- st_read(system.file("shapes/auckland.shp", package="spData")[1], quiet=TRUE)
auckland.nb <- poly2nb(auckland)
auckland.nb
auckland$M77_85
9*auckland$Und5_81
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos')
tasas_ntd_df %>% filter(sexo== '3.Ambos sexos') %>% select(observados)
tasas_ntd_df$observados[tasas_ntd_df$sexo== '3.Ambos sexos']
EBlocal(tasas_ntd_df$observados[tasas_ntd_df$sexo== '3.Ambos sexos'],
tasas_ntd_df$esperados[tasas_ntd_df$sexo== '3.Ambos sexos'],
matriz)
EBlocal(tasas_ntd_df$observados[tasas_ntd_df$sexo== '3.Ambos sexos'],
tasas_ntd_df$esperados[tasas_ntd_df$sexo== '3.Ambos sexos'],
matriz)$est
tasas_ntd_df[tasas_ntd_df$sexo== '3.Ambos sexos',9] <- EBlocal(tasas_ntd_df$observados[tasas_ntd_df$sexo== '3.Ambos sexos'],
tasas_ntd_df$esperados[tasas_ntd_df$sexo== '3.Ambos sexos'],
matriz)$est
sexo = unique(tasas_ntd_df$sexo)
sexo
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,9] <- EBlocal(tasas_ntd_df$observados[tasas_ntd_df$sexo== sexo],
tasas_ntd_df$esperados[tasas_ntd_df$sexo== sexo],
matriz)$est
print(sexo)
}
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,9] <- EBlocal(tasas_ntd_df$observados[tasas_ntd_df$sexo== sexo],
tasas_ntd_df$esperados[tasas_ntd_df$sexo== sexo],
matriz)$est*100
print(sexo)
}
colnames(tasas_ntd_df)[9] <- 'suavizadas'
save(tasas_ntd_df,file="tasas/tasas_ntd_suav.RData")
library(tidyverse)
library(R.utils)
library(foreign)
library(sf)
library(epitools)
library(spdep)
load(tasas_ntd_df,file="tasas/tasas_ntd_suav.RData")
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
data(afcon, package="spData")
View(africa.rook.nb)
View(afcon)
oid <- order(afcon$id)
sexo
sexo = '3.Ambos sexo'
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz))
sexo = '3.Ambos sexo'
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz))
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]
load(file="tasas/tasas_ntd_suav.RData")
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]
tasas_ntd_df$suavizadas
sexo
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]
View(tasas_ntd_df)
sexo = '3.Ambos sexos'
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz))
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))
sexo = unique(tasas_ntd_df$sexo)
res <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))
sexo = unique(tasas_ntd_df$sexo)
res <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))
res
View(res)
res
res[[1]]
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))$quadr
vv <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))$quadr
vv <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))
View(vv)
str(vv)
attr(vv, "quadr")
vv <- attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr")
vv
vv <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))
vv <- localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
sexo
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr")
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
tasas_ntd_df[tasas_ntd_df$sexo== sexo]
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
View(tasas_ntd_df)
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
tasas_ntd_df[tasas_ntd_df$sexo== sexo,]
tasas_ntd_df[tasas_ntd_df$sexo== sexo,]
tasas_ntd_df[tasas_ntd_df$sexo== sexo,]
sexo
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
sexo
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
load(file="tasas/tasas_ntd_suav.RData")
sexo = unique(tasas_ntd_df$sexo)
sexo = "1.Varones"
tasas_ntd_df[tasas_ntd_df$sexo== sexo,]
tasas_ntd_df[tasas_ntd_df$sexo== sexo]
cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
sexo = "1.Varones"
cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
sexo = "1.Varones"
tasas_ntd_df[tasas_ntd_df$sexo== sexo,1] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
sexo = "1.Varones"
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(tasas_ntd_df[tasas_ntd_df$sexo== sexo,],
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
View(tasas_ntd_df)
load(file="tasas/tasas_ntd_suav.RData")
tasas_ntd_df$
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
View(tasas_ntd_df)
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo],nb2listw(matriz,style = "B")),"quadr")
load(file="tasas/tasas_ntd_suav.RData")
matriz <- read.gal("matriz de vecindad/matriz")
tasas_ntd_df$
sexo = unique(tasas_ntd_df$sexo)
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr")
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
nb2listw(matriz,style = "B"))
nb2listw(matriz,style = "B")
cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
)
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]]
attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr")
sexo[1]
tasas_ntd_df[is.na(tasas_ntd_df)] <- 0
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(10:14)] <- cbind(attr(localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B")),"quadr"),
localmoran(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo[1]],nb2listw(matriz,style = "B"))[,c(1,5)]
)
print(sexo)
}
tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]
tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
)
mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]
mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
sexo
sexo = unique(tasas_ntd_df$sexo)
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)]
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
)
sexo = unique(tasas_ntd_df$sexo)
for(sexo in sexo){
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(15)] <- tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$Ii[tasas_ntd_df$sexo== sexo])
tasas_ntd_df[tasas_ntd_df$sexo== sexo,c(16)] <- tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo]-mean(tasas_ntd_df$suavizadas[tasas_ntd_df$sexo== sexo])
print(sexo)
}
